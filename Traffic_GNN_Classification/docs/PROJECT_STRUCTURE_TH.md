# üìÇ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ Traffic GNN Classification ‡πÅ‡∏ö‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô **6 ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å**:

```
Traffic_GNN_Classification/
‚îú‚îÄ‚îÄ üìÅ src/          ‚Üí ‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö (‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• + ‡πÇ‡∏°‡πÄ‡∏î‡∏•)
‚îú‚îÄ‚îÄ üìÅ app/          ‚Üí Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
‚îú‚îÄ‚îÄ üìÅ Data/         ‚Üí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö
‚îú‚îÄ‚îÄ üìÅ outputs/      ‚Üí ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô
‚îú‚îÄ‚îÄ üìÅ docs/         ‚Üí ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö
‚îî‚îÄ‚îÄ üìú Scripts       ‚Üí ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏ó‡∏£‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö
```

---

## 1Ô∏è‚É£ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `src/` - ‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö

### **üìÅ src/data/ - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**

#### **üìÑ `data_processor.py`**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ

**‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:**

```python
class TrafficDataProcessor:
    """‡∏Ñ‡∏•‡∏≤‡∏™‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£"""
    
    # 1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    def load_probe_data(self, file_path):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå PROBE data (CSV)
        Input: path ‡πÑ‡∏ü‡∏•‡πå (‡πÄ‡∏ä‡πà‡∏ô PROBE-202401/20240101.csv.out)
        Output: DataFrame ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå:
            - timestamp
            - location_id
            - latitude, longitude
            - speed
            - heading
            - quality
        
        ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
        1. ‡∏≠‡πà‡∏≤‡∏ô CSV file
        2. ‡πÅ‡∏õ‡∏•‡∏á timestamp ‡πÄ‡∏õ‡πá‡∏ô datetime
        3. ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
        """
    
    # 2. ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    def clean_data(self, df):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        
        ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:
        1. ‡∏•‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (>150 km/h)
        2. ‡∏•‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ô‡∏≠‡∏Å‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
        3. ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥
        4. ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ (interpolation)
        
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
        Before: [45, -10, 200, 40, 35]
        After:  [45, 40, 40, 40, 35]  # ‡∏•‡∏ö/‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
        """
    
    # 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Features
    def create_features(self, df):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (features) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
        
        Features ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á (10 features):
        
        A. Speed Features (3 features):
           - mean_speed: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
           - median_speed: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏•‡∏≤‡∏á
           - speed_std: ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
           
           ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å: speeds ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 5 ‡∏ô‡∏≤‡∏ó‡∏µ
           
        B. Count Features (1 feature):
           - count_probes: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ
           
        C. Quality Feature (1 feature):
           - quality_score: ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (0-1)
           
        D. Temporal Features (5 features):
           - hour_sin, hour_cos: ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á encode ‡∏î‡πâ‡∏ß‡∏¢ sine/cosine
           - dow_sin, dow_cos: ‡∏ß‡∏±‡∏ô encode ‡∏î‡πâ‡∏ß‡∏¢ sine/cosine
           - is_weekend: ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (0/1)
           
           ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á hour encoding:
           hour = 14  # 14:00
           angle = 2œÄ √ó 14 / 24 = 3.665
           hour_sin = sin(3.665) = -0.258
           hour_cos = cos(3.665) = -0.966
        """
    
    # 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Labels
    def create_labels(self, df):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö (labels) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏ô
        
        A. Congestion Label (4 classes):
           if mean_speed < 20:  ‚Üí 0 (Gridlock)
           elif mean_speed < 40: ‚Üí 1 (Congested)
           elif mean_speed < 60: ‚Üí 2 (Moderate)
           else:                 ‚Üí 3 (Free Flow)
        
        B. Rush Hour Label (2 classes):
           if (7 <= hour < 9) or (17 <= hour < 19):
               and is_weekday:
               ‚Üí 1 (Rush Hour)
           else:
               ‚Üí 0 (Non-Rush Hour)
        """
    
    # 5. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    def save_processed_data(self, data, path):
        """‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡πá‡∏ô .pkl"""
    
    def load_processed_data(self, path):
        """‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ß‡πâ"""
```

**‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- üì• **‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** ‡∏à‡∏≤‡∏Å PROBE files
- üßπ **‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î** ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
- üîß **‡∏™‡∏£‡πâ‡∏≤‡∏á Features** 10 features ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
- üè∑Ô∏è **‡∏™‡∏£‡πâ‡∏≤‡∏á Labels** congestion + rush hour
- üíæ **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÇ‡∏´‡∏•‡∏î** ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß

---

### **üìÅ src/models/ - ‡πÇ‡∏°‡πÄ‡∏î‡∏• Neural Network**

#### **üìÑ `multi_task_gnn.py`**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÇ‡∏°‡πÄ‡∏î‡∏• GNN ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢

**‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:**

```python
# ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà 1: Simple Model (‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô)
class SimpleMultiTaskGNN(torch.nn.Module):
    """
    ‡πÇ‡∏°‡πÄ‡∏î‡∏• GNN ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å 2 tasks
    
    ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°:
    Input (10 features)
        ‚Üì
    Linear Layer 1 (10 ‚Üí 64)
        ‚Üì
    ReLU Activation
        ‚Üì
    Linear Layer 2 (64 ‚Üí 64)
        ‚Üì
    ReLU Activation
        ‚Üì
        ‚îú‚îÄ‚îÄ‚Üí Congestion Head (64 ‚Üí 4)
        ‚îî‚îÄ‚îÄ‚Üí Rush Hour Head (64 ‚Üí 2)
    """
    
    def __init__(self, num_features=10, hidden_dim=64):
        """
        Parameters:
            num_features: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô input features (10)
            hidden_dim: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô neurons ‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏ã‡πà‡∏≠‡∏ô (64)
        
        Layers:
            - fc1: Linear(10, 64) + bias
              Parameters: 10√ó64 + 64 = 704
            
            - fc2: Linear(64, 64) + bias
              Parameters: 64√ó64 + 64 = 4,160
            
            - congestion_head: Linear(64, 4)
              Parameters: 64√ó4 + 4 = 260
            
            - rush_hour_head: Linear(64, 2)
              Parameters: 64√ó2 + 2 = 130
        
        Total Parameters: 704 + 4,160 + 260 + 130 = 5,254
        """
    
    def forward(self, x):
        """
        Forward pass - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        
        Input:
            x: tensor shape (batch_size, 10)
            ‡πÄ‡∏ä‡πà‡∏ô (32, 10) = batch 32 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        
        ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
        1. x ‚Üí fc1 ‚Üí (32, 64)
        2. ReLU ‚Üí (32, 64) # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡πÄ‡∏õ‡πá‡∏ô 0
        3. x ‚Üí fc2 ‚Üí (32, 64)
        4. ReLU ‚Üí (32, 64)
        5. Branch ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏ó‡∏≤‡∏á:
           - congestion_head ‚Üí (32, 4) # 4 classes
           - rush_hour_head ‚Üí (32, 2)  # 2 classes
        
        Output:
            dict {
                'congestion_logits': (32, 4),
                'rush_hour_logits': (32, 2)
            }
        """

# ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà 2: Enhanced Model (‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á)
class EnhancedGNNModel(torch.nn.Module):
    """
    ‡πÇ‡∏°‡πÄ‡∏î‡∏• GNN ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á ‡∏°‡∏µ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
    
    ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°:
    Input (10 features)
        ‚Üì
    [Linear 128 + BatchNorm + ReLU + Dropout] ‚îÄ‚îê
        ‚Üì                                       ‚îÇ
    [Linear 128 + BatchNorm + ReLU + Dropout] ‚Üê‚îò Residual
        ‚Üì                                       ‚îÇ
    [Linear 128 + BatchNorm + ReLU + Dropout] ‚Üê‚îò Residual
        ‚Üì
    Multi-Head Attention (4 heads)
        ‚Üì
        ‚îú‚îÄ‚îÄ‚Üí Deep Congestion Head (128‚Üí64‚Üí4)
        ‚îî‚îÄ‚îÄ‚Üí Deep Rush Hour Head (128‚Üí64‚Üí2)
    """
    
    def __init__(self, num_features=10, hidden_dim=128, dropout=0.3):
        """
        Parameters:
            hidden_dim: 128 neurons (‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ Simple)
            dropout: 0.3 (‡∏õ‡∏¥‡∏î 30% ‡∏Ç‡∏≠‡∏á neurons)
        
        ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°:
        1. BatchNorm - normalize ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ batch
        2. Residual - ‡πÄ‡∏û‡∏¥‡πà‡∏° shortcut connections
        3. Attention - ‡πÇ‡∏°‡πÄ‡∏î‡∏• "‡∏™‡∏ô‡πÉ‡∏à" ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
        4. Dropout - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô overfitting
        5. Deep Heads - classification heads ‡∏ó‡∏µ‡πà‡∏•‡∏∂‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô
        
        Total Parameters: ~62,000 (‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ Simple 12 ‡πÄ‡∏ó‡πà‡∏≤)
        """
    
    def forward(self, x):
        """
        Forward pass ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á
        
        ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
        1. Layer 1 + BatchNorm + ReLU + Dropout
        2. Layer 2 + residual connection
        3. Layer 3 + residual connection
        4. Multi-head attention (4 heads)
        5. Deep classification heads
        
        Residual connection ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£:
        out = Layer(x) + x  # ‡πÄ‡∏û‡∏¥‡πà‡∏° input ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
        
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
        x = [1, 2, 3]
        Layer(x) = [4, 5, 6]
        out = [4, 5, 6] + [1, 2, 3] = [5, 7, 9]
        """
```

**‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- üß† **SimpleMultiTaskGNN** - ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (5K parameters)
- üöÄ **EnhancedGNNModel** - ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (62K parameters)
- üìä **Multi-Task Learning** - ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ 2 tasks ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
- ‚ö° **Forward Pass** - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å input

---

### **üìÅ src/utils/ - ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠**

#### **üìÑ `graph_constructor.py`**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏ô‡∏ô

**‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:**

```python
class GraphConstructor:
    """‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≤‡∏ü‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ñ‡∏ô‡∏ô"""
    
    def __init__(self, locations):
        """
        Parameters:
            locations: list ‡∏Ç‡∏≠‡∏á (latitude, longitude)
            ‡πÄ‡∏ä‡πà‡∏ô [(13.7563, 100.5018), (13.7600, 100.5050), ...]
        """
    
    def build_graph(self):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏≤‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
        
        ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
        1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà (Haversine)
        2. ‡∏™‡∏£‡πâ‡∏≤‡∏á edges ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á
        3. ‡∏™‡∏£‡πâ‡∏≤‡∏á adjacency matrix
        
        Output:
            - nodes: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà (217)
            - edges: ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ [(0,1), (0,5), (1,2), ...]
            - distances: ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ edge
        """
    
    def calculate_haversine_distance(self, lat1, lon1, lat2, lon2):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏ö‡∏ô‡πÇ‡∏•‡∏Å
        
        ‡∏™‡∏π‡∏ï‡∏£ Haversine:
        a = sin¬≤(Œîlat/2) + cos(lat1)√ócos(lat2)√ósin¬≤(Œîlon/2)
        c = 2 √ó arcsin(‚àöa)
        distance = R √ó c  (R = 6371 km)
        
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
        Input: 
            lat1=13.7447, lon1=100.5298  (MBK)
            lat2=13.7467, lon2=100.5343  (Siam)
        Output:
            distance = 0.523 km
        """
    
    def find_neighbors(self, node_id, k=5):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á k ‡∏ï‡∏±‡∏ß
        
        Parameters:
            node_id: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à
            k: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        
        ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
        Input: node_id=0, k=5
        Output: [1, 5, 12, 23, 45]  # 5 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
        """
    
    def create_adjacency_matrix(self):
        """
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏ó‡∏£‡∏¥‡∏Å‡∏ã‡πå‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
        
        Output: matrix (217, 217)
        [
          [0, 1, 0, 0, 1, ...],  # node 0 ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö 1 ‡πÅ‡∏•‡∏∞ 4
          [1, 0, 1, 0, 0, ...],  # node 1 ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö 0 ‡πÅ‡∏•‡∏∞ 2
          ...
        ]
        
        1 = ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ô, 0 = ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°
        """
```

**‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- üìç **‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü** ‡∏à‡∏≤‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
- üìè **‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á** ‡∏î‡πâ‡∏ß‡∏¢ Haversine
- üîó **‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ö‡πâ‡∏≤‡∏ô** ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á
- üìä **Adjacency Matrix** ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠

---

## 2Ô∏è‚É£ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `app/` - Dashboard

#### **üìÑ `dashboard.py`**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô Streamlit ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

**‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:**

```python
# ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: Setup
import streamlit as st
import sys
import os

# ‡πÄ‡∏û‡∏¥‡πà‡∏° path ‡πÄ‡∏û‡∏∑‡πà‡∏≠ import modules
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.insert(0, parent_dir)

# Import modules
from config import *
from utils import *
from tabs import home, prediction, analysis, model_info, route_optimizer

# ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Page Configuration
st.set_page_config(
    page_title="Traffic GNN Classification",
    page_icon="üö¶",
    layout="wide"
)

# ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: Load Model
@st.cache_resource
def load_model():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏£‡∏ô‡πÑ‡∏ß‡πâ
    Cache ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ã‡πâ‡∏≥
    """
    model = torch.load('outputs/best_model.pth')
    return model

# ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: Sidebar - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•
model_choice = st.sidebar.selectbox(
    "Select Model",
    ["Simple GNN", "Enhanced GNN"]
)

# ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 5: Main Content - ‡πÅ‡∏ó‡πá‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ
tab1, tab2, tab3, tab4, tab5 = st.tabs([
    "üè† Home",
    "üîÆ Prediction",
    "üìä Analysis",
    "üß† Model Info",
    "üó∫Ô∏è Route Optimizer"
])

with tab1:
    home.show()  # ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å

with tab2:
    prediction.show()  # ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢

with tab3:
    analysis.show()  # ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå

with tab4:
    model_info.show()  # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏°‡πÄ‡∏î‡∏•

with tab5:
    route_optimizer.show()  # ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
```

#### **üìÅ `app/tabs/` - ‡πÅ‡∏ó‡πá‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ**

```python
# tabs/home.py
def show():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
    - ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
    - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    - Quick links
    """

# tabs/prediction.py
def show():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
    
    ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:
    1. ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡πâ‡∏≠‡∏ô input:
       - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
       - ‡πÄ‡∏ß‡∏•‡∏≤
       - ‡∏ß‡∏±‡∏ô
    2. ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•
    3. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢:
       - ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏≠‡∏≠‡∏±‡∏î (Gridlock/Congested/Moderate/Free)
       - Rush Hour (Yes/No)
       - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à (Confidence)
    """

# tabs/analysis.py
def show():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    
    ‡πÅ‡∏™‡∏î‡∏á:
    - ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£
    - Heatmap ‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤
    - ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
    - ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
    """

# tabs/model_info.py
def show():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏°‡πÄ‡∏î‡∏•
    
    ‡πÅ‡∏™‡∏î‡∏á:
    - ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÇ‡∏°‡πÄ‡∏î‡∏•
    - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô parameters
    - ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô (accuracy, loss)
    - Confusion matrix
    """

# tabs/route_optimizer.py
def show():
    """
    ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà: ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
    
    ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:
    1. ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô-‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (217 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà)
    2. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (Haversine)
    3. ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÉ‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
    4. ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (Folium)
    5. ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
    """
```

**‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- üñ•Ô∏è **dashboard.py** - ‡πÅ‡∏≠‡∏õ‡∏´‡∏•‡∏±‡∏Å Streamlit
- üè† **home** - ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
- üîÆ **prediction** - ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£
- üìä **analysis** - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- üß† **model_info** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏°‡πÄ‡∏î‡∏•
- üó∫Ô∏è **route_optimizer** - ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á

---

## 3Ô∏è‚É£ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `Data/` - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö

```
Data/
‚îú‚îÄ‚îÄ PROBE-202401/           # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GPS ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2024
‚îÇ   ‚îú‚îÄ‚îÄ 20240101.csv.out   # 1 ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≠ 1 ‡∏ß‡∏±‡∏ô
‚îÇ   ‚îú‚îÄ‚îÄ 20240102.csv.out
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ PROBE-202402/           # ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2024
‚îú‚îÄ‚îÄ PROBE-202403/           # ‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2024
‚îú‚îÄ‚îÄ ...                     # ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ
‚îÇ
‚îú‚îÄ‚îÄ hotosm_tha_roads_lines_gpkg/  # ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ñ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å OpenStreetMap
‚îÇ   ‚îî‚îÄ‚îÄ *.gpkg             # ‡πÑ‡∏ü‡∏•‡πå GeoPackage
‚îÇ
‚îî‚îÄ‚îÄ iTIC-Longdo-Traffic-events-2022/  # ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£
    ‚îú‚îÄ‚îÄ 01/                # ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°
    ‚îú‚îÄ‚îÄ 02/                # ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå
    ‚îî‚îÄ‚îÄ ...
```

**‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• PROBE:**
```csv
timestamp,location_id,latitude,longitude,speed,heading,quality
2024-01-01 00:05:00,LOC001,13.7563,100.5018,45.5,90.0,0.85
```

---

## 4Ô∏è‚É£ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `outputs/` - ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

```
outputs/
‚îú‚îÄ‚îÄ üìÑ processed_data.pkl              # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß
‚îÇ   ‚Üí ‡πÉ‡∏ä‡πâ‡πÇ‡∏î‡∏¢: data_processor.py
‚îÇ   ‚Üí ‡πÄ‡∏Å‡πá‡∏ö: DataFrame ‡∏û‡∏£‡πâ‡∏≠‡∏° features + labels
‚îÇ
‚îú‚îÄ‚îÄ üìÑ best_model.pth                  # ‡πÇ‡∏°‡πÄ‡∏î‡∏• Simple ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
‚îÇ   ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: train.py
‚îÇ   ‚Üí ‡πÄ‡∏Å‡πá‡∏ö: model weights + optimizer state
‚îÇ   ‚Üí ‡∏Ç‡∏ô‡∏≤‡∏î: ~50 KB
‚îÇ
‚îú‚îÄ‚îÄ üìÑ best_enhanced_model.pth         # ‡πÇ‡∏°‡πÄ‡∏î‡∏• Enhanced ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
‚îÇ   ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: enhanced_train.py
‚îÇ   ‚Üí ‡πÄ‡∏Å‡πá‡∏ö: model weights + optimizer state
‚îÇ   ‚Üí ‡∏Ç‡∏ô‡∏≤‡∏î: ~250 KB
‚îÇ
‚îú‚îÄ‚îÄ üìÑ training_history.pkl            # ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô Simple
‚îÇ   ‚Üí ‡πÄ‡∏Å‡πá‡∏ö: train_loss, val_loss, accuracy ‡πÅ‡∏ï‡πà‡∏•‡∏∞ epoch
‚îÇ
‚îú‚îÄ‚îÄ üìÑ training_history.png            # ‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô Simple
‚îÇ   ‚Üí ‡πÅ‡∏™‡∏î‡∏á: Loss curves, Accuracy curves
‚îÇ
‚îú‚îÄ‚îÄ üìÑ enhanced_training_history.png   # ‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô Enhanced
‚îÇ
‚îú‚îÄ‚îÄ üìÑ enhanced_confusion_matrices.png # Confusion matrices
‚îÇ   ‚Üí ‡πÅ‡∏™‡∏î‡∏á: ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞ class
‚îÇ
‚îú‚îÄ‚îÄ üìÑ model_comparison.png            # ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
‚îÇ   ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: compare_models.py
‚îÇ
‚îî‚îÄ‚îÄ üìÑ evaluation_results.pkl          # ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
    ‚Üí ‡πÄ‡∏Å‡πá‡∏ö: predictions, targets, metrics
```

---

## 5Ô∏è‚É£ Scripts - ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏ó‡∏£‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠

### **üìú `train.py` - ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• Simple (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡πâ‡∏ß)**

**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• SimpleMultiTaskGNN ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á 5 ‡∏≠‡∏¢‡πà‡∏≤‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏£‡∏±‡∏ô:**
```powershell
py train.py --epochs 100 --batch_size 32 --patience 20
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- `outputs/best_model.pth`
- `outputs/training_history.png`
- Accuracy ~98%

---

### **üìú `enhanced_train.py` - ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• Enhanced**

**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• EnhancedGNNModel

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏£‡∏±‡∏ô:**
```powershell
py enhanced_train.py --epochs 100 --batch_size 64 --hidden_dim 128
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- `outputs/best_enhanced_model.pth`
- `outputs/enhanced_training_history.png`
- Accuracy ~98-99%

---

## üîÑ Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### **1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
```
PROBE Data (CSV)
    ‚Üì
data_processor.py ‚Üí load_probe_data()
    ‚Üì
clean_data() ‚Üí ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
    ‚Üì
create_features() ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á 10 features
    ‚Üì
create_labels() ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á labels
    ‚Üì
processed_data.pkl (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)
```

### **2. ‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•:**
```
processed_data.pkl
    ‚Üì
train.py ‚Üí prepare_data()
    ‚Üì
create_simple_datasets() ‚Üí 70/15/15 split
    ‚Üì
train_simple_model()
    ‚îú‚îÄ SimpleMultiTaskGNN
    ‚îú‚îÄ AdamW optimizer
    ‚îú‚îÄ ReduceLROnPlateau scheduler
    ‚îî‚îÄ Training loop (100 epochs)
    ‚Üì
best_model.pth (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)
```

### **3. ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Dashboard:**
```
dashboard.py (‡πÄ‡∏õ‡∏¥‡∏î)
    ‚Üì
load_model() ‚Üí ‡πÇ‡∏´‡∏•‡∏î best_model.pth
    ‚Üì
User ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å tab ‚Üí show()
    ‚îú‚îÄ Home
    ‚îú‚îÄ Prediction ‚Üí ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
    ‚îú‚îÄ Analysis ‚Üí ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
    ‚îú‚îÄ Model Info ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    ‚îî‚îÄ Route Optimizer ‚Üí ‡∏´‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
```

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å | Input | Output |
|------|-------------|-------|--------|
| **data_processor.py** | ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | PROBE CSV | processed_data.pkl |
| **multi_task_gnn.py** | ‡πÇ‡∏°‡πÄ‡∏î‡∏• GNN | Features (10) | Predictions (4+2) |
| **graph_constructor.py** | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü | Locations | Graph structure |
| **train.py** | ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• Simple | processed_data | best_model.pth |
| **enhanced_train.py** | ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• Enhanced | processed_data | best_enhanced_model.pth |
| **compare_models.py** | ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö | 2 models | Comparison plots |
| **dashboard.py** | ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Web | Model + Data | Interactive UI |

---

## üéØ ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô

### **Data (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•):**
```
PROBE files ‚Üí data_processor.py ‚Üí Features + Labels
```

### **Model (‡πÇ‡∏°‡πÄ‡∏î‡∏•):**
```
Features ‚Üí multi_task_gnn.py ‚Üí Predictions
```

### **Training (‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô):**
```
Data ‚Üí train.py/enhanced_train.py ‚Üí Trained Model
```

### **Application (‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô):**
```
User Input ‚Üí dashboard.py ‚Üí Model ‚Üí Predictions ‚Üí Display
```

---

‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£! üéì‚ú®
