# üìò ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î: config.py

## üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå

- **‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå:** `src/config/config.py`
- **‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
- **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:** ~220 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
- **‡∏†‡∏≤‡∏©‡∏≤:** Python
- **‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå:** 60+ ‡∏ï‡∏±‡∏ß

---

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÑ‡∏ü‡∏•‡πå `config.py` ‡πÄ‡∏õ‡πá‡∏ô **Configuration Center** ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢

### **‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå:**
‚úÖ ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï  
‚úÖ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á hard-code ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏µ‡πà  
‚úÖ ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢  
‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î

---

## üìÇ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```python
config.py
‚îú‚îÄ‚îÄ 1. DATA CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 11-44)
‚îú‚îÄ‚îÄ 2. MODEL CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 46-68)
‚îú‚îÄ‚îÄ 3. TRAINING CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 70-94)
‚îú‚îÄ‚îÄ 4. GRAPH CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 96-108)
‚îú‚îÄ‚îÄ 5. OUTPUT CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 110-126)
‚îú‚îÄ‚îÄ 6. DASHBOARD CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 128-156)
‚îú‚îÄ‚îÄ 7. LOGGING CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 158-168)
‚îú‚îÄ‚îÄ 8. THAI LOCALIZATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 170-193)
‚îú‚îÄ‚îÄ 9. SYSTEM CONFIGURATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 195-213)
‚îî‚îÄ‚îÄ 10. VALIDATION (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 215-219)
```

---

## 1Ô∏è‚É£ DATA CONFIGURATION

### **üìç Path Configuration**

```python
DATA_PATH = os.path.join("..", "Data")
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î path ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å
- `".."` = ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö 1 ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: `../Data/`

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```python
from config import DATA_PATH
probe_path = os.path.join(DATA_PATH, "PROBE-202401")
# ‡πÑ‡∏î‡πâ: ../Data/PROBE-202401
```

---

```python
ROAD_NETWORK_PATH = os.path.join(DATA_PATH, "hotosm_tha_roads_lines_gpkg")
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏ô‡∏ô
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å OpenStreetMap (OSM)
- ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå: `.gpkg` (GeoPackage)

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå:**
- ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Ç‡πà‡∏≤‡∏¢‡∏ñ‡∏ô‡∏ô‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
- ‡∏û‡∏¥‡∏Å‡∏±‡∏î (latitude, longitude)
- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ñ‡∏ô‡∏ô (highway, local road, etc.)
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ñ‡∏ô‡∏ô

---

```python
PROBE_FOLDERS = [
    "PROBE-202401",
    "PROBE-202402",
    "PROBE-202403",
    ...
]
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GPS probe
- ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå = 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å: ‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πà‡∏á‡∏ö‡∏ô‡∏ñ‡∏ô‡∏ô‡∏à‡∏£‡∏¥‡∏á

**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• PROBE:**
```csv
timestamp,location_id,latitude,longitude,speed,heading,quality
2024-01-01 00:05:00,LOC001,13.7563,100.5018,45.5,90.0,0.85
```

**Fields ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- `timestamp`: ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- `location_id`: ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
- `latitude, longitude`: ‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS
- `speed`: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (km/h)
- `heading`: ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á (0-360¬∞)
- `quality`: ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (0-1)

---

### **‚öôÔ∏è Data Processing Parameters**

```python
AGGREGATION_MINUTES = 5
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å **5 ‡∏ô‡∏≤‡∏ó‡∏µ**
- ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• real-time ‚Üí time series

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö (‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
08:00:30 - 45 km/h
08:01:15 - 47 km/h
08:02:50 - 43 km/h
08:03:20 - 46 km/h
08:04:10 - 44 km/h

# ‡∏´‡∏•‡∏±‡∏á Aggregation (‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ)
08:00-08:05 - mean: 45.0 km/h, std: 1.58
```

**‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á aggregate?**
- ‡∏•‡∏î noise ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î memory)
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô

---

```python
MIN_PROBES_PER_BIN = 3
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ **3 ‡∏£‡∏ñ** ‡∏ï‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
- ‡∏ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‚Üí ‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡πâ‡∏ô

**‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:**
- 1-2 ‡∏£‡∏ñ = ‡πÑ‡∏°‡πà‡πÅ‡∏ó‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á
- ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏ñ‡πÅ‡∏Ç‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏ñ‡πÄ‡∏ï‡πà‡∏≤
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡∏ä‡πà‡∏ß‡∏á 08:00-08:05
locations = {
    'LOC001': 5 ‡∏£‡∏ñ  ‚úÖ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
    'LOC002': 3 ‡∏£‡∏ñ  ‚úÖ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ (‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥)
    'LOC003': 2 ‡∏£‡∏ñ  ‚ùå ‡∏ó‡∏¥‡πâ‡∏á (‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
}
```

---

```python
MAX_SPEED_THRESHOLD = 150  # km/h
MIN_SPEED_THRESHOLD = 0
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•
- ‡∏ä‡πà‡∏ß‡∏á: **0-150 km/h**

**‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á:**
```python
def filter_speed(speed):
    if speed < MIN_SPEED_THRESHOLD:  # < 0
        return None  # ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ï‡∏¥‡∏î‡∏•‡∏ö
    elif speed > MAX_SPEED_THRESHOLD:  # > 150
        return None  # ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á
    else:
        return speed  # ‚úÖ ‡∏õ‡∏Å‡∏ï‡∏¥
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
```python
speeds = [45, -10, 120, 250, 0, 80]

# ‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏á
speeds_filtered = [45, 120, 0, 80]
# ‡∏ó‡∏¥‡πâ‡∏á: -10 (‡∏ï‡∏¥‡∏î‡∏•‡∏ö), 250 (‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
```

---

```python
MIN_QUALITY_SCORE = 0.3
MAX_DISTANCE_TO_ROAD = 100  # meters
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

**1. MIN_QUALITY_SCORE:**
- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚â• 0.3
- Quality score ‡∏°‡∏≤‡∏à‡∏≤‡∏Å GPS accuracy

**2. MAX_DISTANCE_TO_ROAD:**
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ñ‡∏ô‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 100 ‡πÄ‡∏°‡∏ï‡∏£
- ‡∏Å‡∏£‡∏≠‡∏á GPS drift (‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô)

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GPS
point1 = {
    'lat': 13.7563, 
    'lon': 100.5018,
    'quality': 0.85,
    'distance_to_road': 15  # ‡πÄ‡∏°‡∏ï‡∏£
}
# ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô: quality ‚â• 0.3, distance ‚â§ 100

point2 = {
    'lat': 13.9999,
    'lon': 100.9999,
    'quality': 0.2,
    'distance_to_road': 500
}
# ‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô: quality < 0.3, distance > 100
```

---

## 2Ô∏è‚É£ MODEL CONFIGURATION

### **üèóÔ∏è Architecture Parameters**

```python
NUM_FEATURES = 10
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô input features = **10**
- ‡∏ó‡∏∏‡∏Å features ‡∏õ‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•

**10 Features ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?**

| # | Feature | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | ‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡πà‡∏≤ |
|---|---------|----------|---------|
| 1 | `speed_mean` | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ | 0-150 km/h |
| 2 | `speed_median` | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏•‡∏≤‡∏á | 0-150 km/h |
| 3 | `speed_std` | ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß | 0-50 km/h |
| 4 | `hour_sin` | ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (sine) | -1 to 1 |
| 5 | `hour_cos` | ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (cosine) | -1 to 1 |
| 6 | `day_of_week` | ‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå | 0-6 |
| 7 | `is_weekend` | ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà | 0 or 1 |
| 8 | `time_since_rush` | ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô | 0-12 ‡∏ä‡∏°. |
| 9 | `nearby_congestion` | ‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á | 0-3 |
| 10 | `speed_lag_1` | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô | 0-150 km/h |

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 1 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
sample = [
    45.5,    # speed_mean
    44.0,    # speed_median
    5.2,     # speed_std
    0.707,   # hour_sin (08:00)
    0.707,   # hour_cos
    1,       # day_of_week (‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£)
    0,       # is_weekend (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà)
    0.5,     # time_since_rush
    1,       # nearby_congestion
    48.0     # speed_lag_1
]
```

---

```python
HIDDEN_DIM = 64
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏Ç‡∏ô‡∏≤‡∏î hidden layer = **64 neurons**
- ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á input ‡πÅ‡∏•‡∏∞ output

**‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°:**
```
Input Layer (10)
    ‚Üì
Hidden Layer 1 (64) ‚Üê HIDDEN_DIM
    ‚Üì
Hidden Layer 2 (64)
    ‚Üì
Output Layer (4+2)
```

**‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 64?**

| ‡∏Ç‡∏ô‡∏≤‡∏î | ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ | ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢ |
|------|-------|---------|
| 16 | ‡πÄ‡∏£‡πá‡∏ß, ‡πÄ‡∏ö‡∏≤ | ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÑ‡∏°‡πà‡∏û‡∏≠ |
| **64** | **‡∏™‡∏°‡∏î‡∏∏‡∏•** ‚úÖ | **‡∏û‡∏≠‡∏î‡∏µ** |
| 256 | ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å | ‡∏ä‡πâ‡∏≤, overfitting |
| 1024 | ‡πÅ‡∏°‡πà‡∏ô‡∏°‡∏≤‡∏Å | ‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å, memory ‡πÄ‡∏¢‡∏≠‡∏∞ |

---

```python
NUM_CONGESTION_CLASSES = 4
NUM_RUSH_HOUR_CLASSES = 2
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ **2 tasks** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (Multi-Task Learning)

**Task 1: Congestion Classification (4 classes)**

| Class | Label | ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|-------|-------|----------|----------|
| 0 | Gridlock | speed < 10 km/h | ‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á |
| 1 | Congested | 10 ‚â§ speed < 30 | ‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î |
| 2 | Moderate | 30 ‚â§ speed < 50 | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á |
| 3 | Free Flow | speed ‚â• 50 | ‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß |

**Task 2: Rush Hour Classification (2 classes)**

| Class | Label | ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç |
|-------|-------|----------|
| 0 | Non-Rush Hour | ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ |
| 1 | Rush Hour | 7-9 ‡∏ô. ‡∏´‡∏£‡∏∑‡∏≠ 17-19 ‡∏ô. |

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
```python
prediction = {
    'congestion': 1,  # Congested
    'rush_hour': 1,   # Rush Hour
    'confidence': {
        'congestion': 0.85,
        'rush_hour': 0.92
    }
}
```

---

### **üö¶ Classification Thresholds**

```python
CONGESTION_THRESHOLDS = {
    'gridlock': 10,
    'congested': 30,
    'moderate': 50,
    'free_flow': float('inf')
}
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£

**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡πÅ‡∏ô‡∏Å:**
```python
def classify_congestion(speed):
    if speed < 10:
        return 0, "Gridlock"
    elif speed < 30:
        return 1, "Congested"
    elif speed < 50:
        return 2, "Moderate"
    else:
        return 3, "Free Flow"
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
classify_congestion(5)   # ‚Üí (0, "Gridlock")
classify_congestion(25)  # ‚Üí (1, "Congested")
classify_congestion(45)  # ‚Üí (2, "Moderate")
classify_congestion(80)  # ‚Üí (3, "Free Flow")
```

**‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏ì‡∏ë‡πå:**
```python
# ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏ñ‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤
CONGESTION_THRESHOLDS = {
    'gridlock': 5,   # ‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Ç‡∏∂‡πâ‡∏ô
    'congested': 20,
    'moderate': 40,
    'free_flow': float('inf')
}

# ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≤‡∏á‡∏î‡πà‡∏ß‡∏ô
CONGESTION_THRESHOLDS = {
    'gridlock': 20,  # ‡∏ú‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏ô‡∏Å‡∏ß‡πà‡∏≤
    'congested': 50,
    'moderate': 80,
    'free_flow': float('inf')
}
```

---

```python
RUSH_HOUR_RANGES = [
    (7, 9),   # Morning: 7:00-9:00
    (17, 19)  # Evening: 17:00-19:00
]
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô
- ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: (‡πÄ‡∏£‡∏¥‡πà‡∏°, ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î) 24-hour format

**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
```python
def is_rush_hour(hour, is_weekday=True):
    if not is_weekday:
        return False  # ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô
    
    for start, end in RUSH_HOUR_RANGES:
        if start <= hour < end:
            return True
    return False
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
is_rush_hour(8, True)   # ‚Üí True (‡πÄ‡∏ä‡πâ‡∏≤)
is_rush_hour(18, True)  # ‚Üí True (‡πÄ‡∏¢‡πá‡∏ô)
is_rush_hour(12, True)  # ‚Üí False (‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á)
is_rush_hour(8, False)  # ‚Üí False (‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î)
```

**‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤:**
```python
# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á
RUSH_HOUR_RANGES = [
    (7, 9),
    (12, 13),  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á
    (17, 19)
]

# ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏¢‡∏≤‡∏ß‡∏ô‡∏≤‡∏ô‡∏Å‡∏ß‡πà‡∏≤
RUSH_HOUR_RANGES = [
    (6, 10),   # ‡πÄ‡∏ä‡πâ‡∏≤‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
    (16, 20)   # ‡πÄ‡∏¢‡πá‡∏ô‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
]
```

---

## 3Ô∏è‚É£ TRAINING CONFIGURATION

### **üìö Training Parameters**

```python
EPOCHS = 50
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô = **50 epochs**
- 1 epoch = ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 1 ‡∏£‡∏≠‡∏ö

**Timeline ‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô:**
```
Epoch 1/50:  Loss = 2.345 (‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏á‡∏á‡∏°‡∏≤‡∏Å)
Epoch 10/50: Loss = 1.234 (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à)
Epoch 25/50: Loss = 0.567 (‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô)
Epoch 40/50: Loss = 0.234 (‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å)
Epoch 50/50: Loss = 0.198 (‡πÄ‡∏Å‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î) ‚úÖ
```

**‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö epochs:**
```python
# Dataset ‡πÄ‡∏•‡πá‡∏Å
EPOCHS = 30  # ‡πÄ‡∏£‡πá‡∏ß, ‡∏≠‡∏≤‡∏à underfit

# Dataset ‡∏Å‡∏•‡∏≤‡∏á
EPOCHS = 50  # ‡∏™‡∏°‡∏î‡∏∏‡∏• ‚úÖ

# Dataset ‡πÉ‡∏´‡∏ç‡πà
EPOCHS = 100  # ‡∏ä‡πâ‡∏≤ ‡πÅ‡∏ï‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Å‡∏ß‡πà‡∏≤
```

---

```python
BATCH_SIZE = 32
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏µ‡∏•‡∏∞ **32 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**
- ‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
total_samples = 1000
batch_size = 32
num_batches = 1000 / 32 = 31.25 ‚âà 32 batches

# ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á batches
Batch 1:  samples [0:32]
Batch 2:  samples [32:64]
Batch 3:  samples [64:96]
...
Batch 31: samples [960:992]
Batch 32: samples [992:1000]  # 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```

**Batch Size vs Performance:**

| Batch Size | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß | Memory | ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏û | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ |
|------------|----------|--------|-----------|-------|
| 8 | ‡∏ä‡πâ‡∏≤ | ‡∏ô‡πâ‡∏≠‡∏¢ | ‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ | Dataset ‡πÄ‡∏•‡πá‡∏Å |
| **32** | **‡∏Å‡∏•‡∏≤‡∏á** | **‡∏Å‡∏•‡∏≤‡∏á** | **‡∏î‡∏µ** | **Standard** ‚úÖ |
| 64 | ‡πÄ‡∏£‡πá‡∏ß | ‡∏°‡∏≤‡∏Å | ‡∏î‡∏µ‡∏°‡∏≤‡∏Å | GPU ‡πÅ‡∏£‡∏á |
| 128 | ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å | ‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å | ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î | GPU ‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å |

---

```python
LEARNING_RATE = 0.001
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ = **0.001** (1e-3)
- ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡πâ‡∏≤‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö weights

**‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï:**
```python
new_weight = old_weight - (LEARNING_RATE √ó gradient)
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
old_weight = 0.5
gradient = 2.0
LEARNING_RATE = 0.001

new_weight = 0.5 - (0.001 √ó 2.0)
           = 0.5 - 0.002
           = 0.498
```

**Learning Rate Comparison:**

| LR | ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡πâ‡∏≤‡∏ß | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß | ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ |
|----|-----------|----------|-------------|-------|
| 0.1 | ‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å | ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å | ‡∏ï‡πà‡∏≥ | ‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î‡∏Ç‡πâ‡∏≤‡∏°‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏î‡∏µ |
| 0.01 | ‡πÉ‡∏´‡∏ç‡πà | ‡πÄ‡∏£‡πá‡∏ß | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏≠‡∏≤‡∏à‡∏û‡∏•‡∏≤‡∏î‡∏ö‡∏≤‡∏á‡∏à‡∏∏‡∏î |
| **0.001** | **‡∏Å‡∏•‡∏≤‡∏á** | **‡∏û‡∏≠‡∏î‡∏µ** | **‡∏î‡∏µ** | **‡∏™‡∏°‡∏î‡∏∏‡∏•** ‚úÖ |
| 0.0001 | ‡πÄ‡∏•‡πá‡∏Å | ‡∏ä‡πâ‡∏≤ | ‡∏™‡∏π‡∏á | ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô |
| 0.00001 | ‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å | ‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å | ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å | ‡∏ä‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ |

**‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Learning Rate Scheduler:**
```python
# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ LR ‡∏™‡∏π‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ ‡∏•‡∏î
Epoch 1-10:  LR = 0.001
Epoch 11-20: LR = 0.0005
Epoch 21-30: LR = 0.0001
Epoch 31+:   LR = 0.00005
```

---

```python
WEIGHT_DECAY = 1e-4  # 0.0001
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- **L2 Regularization** = ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î weights
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô overfitting

**‡∏™‡∏π‡∏ï‡∏£:**
```python
loss_total = loss_task + (WEIGHT_DECAY √ó sum(weight¬≤))
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡πÑ‡∏°‡πà‡∏°‡∏µ weight decay
weights = [1.5, 2.8, 3.2, 4.1]  # ‡πÇ‡∏ï‡∏°‡∏≤‡∏Å
# ‚Üí ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß (overfit)

# ‡∏°‡∏µ weight decay
weights = [0.5, 0.8, 0.9, 1.2]  # ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤
# ‚Üí ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤ (generalize ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô)
```

**‡∏Ñ‡πà‡∏≤ Weight Decay:**

| ‡∏Ñ‡πà‡∏≤ | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ä‡πâ |
|-----|----------|----------|
| 0 | ‡πÑ‡∏°‡πà‡∏°‡∏µ regularization | Dataset ‡πÄ‡∏•‡πá‡∏Å |
| **1e-4** | **‡∏Å‡∏•‡∏≤‡∏á‡πÜ** ‚úÖ | **Standard** |
| 1e-3 | ‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å | Dataset ‡πÉ‡∏´‡∏ç‡πà + overfit ‡∏°‡∏≤‡∏Å |

---

```python
CONGESTION_LOSS_WEIGHT = 1.0
RUSH_HOUR_LOSS_WEIGHT = 1.0
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ task
- ‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô total loss

**‡∏™‡∏π‡∏ï‡∏£:**
```python
total_loss = (CONGESTION_LOSS_WEIGHT √ó congestion_loss) + 
             (RUSH_HOUR_LOSS_WEIGHT √ó rush_hour_loss)
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
congestion_loss = 0.5
rush_hour_loss = 0.3
total_loss = (1.0 √ó 0.5) + (1.0 √ó 0.3) = 0.8

# ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö rush hour ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤
RUSH_HOUR_LOSS_WEIGHT = 2.0
total_loss = (1.0 √ó 0.5) + (2.0 √ó 0.3) = 1.1

# ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö congestion ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤
CONGESTION_LOSS_WEIGHT = 3.0
RUSH_HOUR_LOSS_WEIGHT = 1.0
total_loss = (3.0 √ó 0.5) + (1.0 √ó 0.3) = 1.8
```

---

```python
TRAIN_SPLIT = 0.8
VAL_SPLIT = 0.2
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: **80% ‡πÄ‡∏ó‡∏£‡∏ô, 20% ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö**

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
total_data = 1000 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

# ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
train_size = 1000 √ó 0.8 = 800 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
val_size = 1000 √ó 0.2 = 200 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

# Training Set (800)
- ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•
- ‡πÇ‡∏°‡πÄ‡∏î‡∏• "‡πÄ‡∏´‡πá‡∏ô" ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ

# Validation Set (200)
- ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
- ‡πÇ‡∏°‡πÄ‡∏î‡∏• "‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô" ‡∏ï‡∏≠‡∏ô‡πÄ‡∏ó‡∏£‡∏ô
- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ overfit ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô:**

| Train | Val | Test | ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠ |
|-------|-----|------|----------|
| 60% | 20% | 20% | ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≠‡∏¢ |
| 70% | 15% | 15% | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á |
| **80%** | **20%** | **-** | **‡πÑ‡∏°‡πà‡∏°‡∏µ test set** ‚úÖ |
| 80% | 10% | 10% | ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏¢‡∏≠‡∏∞ |

---

```python
PATIENCE = 10
MIN_DELTA = 0.001
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- **Early Stopping** = ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ó‡∏£‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô

**‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå:**
- `PATIENCE`: ‡∏£‡∏≠ 10 epochs
- `MIN_DELTA`: ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 0.001

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
Epoch 20: val_loss = 0.500
Epoch 21: val_loss = 0.498  # ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô 0.002 > 0.001 ‚úÖ
Epoch 22: val_loss = 0.497  # ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô 0.001 = 0.001 ‚úÖ
Epoch 23: val_loss = 0.497  # ‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô ‚ùå counter=1
Epoch 24: val_loss = 0.498  # ‡πÅ‡∏¢‡πà‡∏•‡∏á ‚ùå counter=2
Epoch 25: val_loss = 0.497  # ‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô ‚ùå counter=3
...
Epoch 33: val_loss = 0.497  # ‚ùå counter=10
‚Üí ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ó‡∏£‡∏ô! (‡∏Ñ‡∏£‡∏ö PATIENCE)

# ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏≤‡∏Å Epoch 22 (‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
```

**‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå:**
- ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (‡πÑ‡∏°‡πà‡πÄ‡∏ó‡∏£‡∏ô‡∏Ñ‡∏£‡∏ö 50 epochs)
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô overfitting
- ‡πÑ‡∏î‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

---

## 4Ô∏è‚É£ GRAPH CONFIGURATION

### **üï∏Ô∏è Graph Construction**

```python
MAX_EDGE_DISTANCE = 500  # meters
MIN_EDGE_DISTANCE = 10   # meters
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á edge (‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°) ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á 10-500 ‡πÄ‡∏°‡∏ï‡∏£

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
# ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2 ‡πÅ‡∏´‡πà‡∏á
A = (13.7465, 100.5326)  # Siam
B = (13.7443, 100.5300)  # MBK

distance = haversine(A, B) = 250 ‡πÄ‡∏°‡∏ï‡∏£

if 10 <= distance <= 500:
    create_edge(A, B)  # ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á edge
```

**‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:**
```python
# < 10 ‡πÄ‡∏°‡∏ï‡∏£
distance = 5 ‡πÄ‡∏°‡∏ï‡∏£
# ‚Üí ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)

# 10-500 ‡πÄ‡∏°‡∏ï‡∏£ ‚úÖ
distance = 250 ‡πÄ‡∏°‡∏ï‡∏£
# ‚Üí ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ)

# > 500 ‡πÄ‡∏°‡∏ï‡∏£
distance = 2000 ‡πÄ‡∏°‡∏ï‡∏£
# ‚Üí ‡πÑ‡∏Å‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô)
```

**‡∏Å‡∏£‡∏≤‡∏ü‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**
```
[Siam] ----250m---- [MBK]
   |                  |
  300m               400m
   |                  |
[CentralWorld]----350m----[Platinum]
```

---

```python
SPATIAL_THRESHOLD = 0.001  # degrees
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡∏†‡∏π‡∏°‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå
- 0.001¬∞ ‚âà 110 ‡πÄ‡∏°‡∏ï‡∏£ (‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û)

**‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤:**
```python
# ‡∏ó‡∏µ‡πà Latitude 13¬∞ (‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û)
1 degree ‚âà 111 km
0.001 degree ‚âà 111 m
0.0001 degree ‚âà 11 m

# ‡∏™‡∏π‡∏ï‡∏£
distance_meters = degrees √ó 111,000
```

**‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```python
def cluster_locations(locations, threshold=0.001):
    """‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å"""
    clusters = []
    for loc in locations:
        if distance_to_nearest_cluster(loc) < threshold:
            add_to_cluster(loc)
        else:
            create_new_cluster(loc)
    return clusters
```

---

```python
INCLUDE_EDGE_FEATURES = True
NORMALIZE_FEATURES = True
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

### **1. INCLUDE_EDGE_FEATURES**

```python
if INCLUDE_EDGE_FEATURES:
    edge_features = {
        'distance': 250,           # ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á (‡πÄ‡∏°‡∏ï‡∏£)
        'speed_diff': 15,          # ‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
        'congestion_diff': 1,      # ‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏≤‡∏à‡∏£
        'same_district': 1,        # ‡πÄ‡∏Ç‡∏ï‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
        'road_type': 'highway'     # ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ñ‡∏ô‡∏ô
    }
```

### **2. NORMALIZE_FEATURES**

```python
# ‡∏Å‡πà‡∏≠‡∏ô Normalize
features = {
    'speed': 45,        # 0-150
    'distance': 2500,   # 0-10000
    'hour': 8,          # 0-24
    'quality': 0.85     # 0-1
}

# ‡∏´‡∏•‡∏±‡∏á Normalize (0-1)
features_norm = {
    'speed': 0.30,      # 45/150
    'distance': 0.25,   # 2500/10000
    'hour': 0.33,       # 8/24
    'quality': 0.85     # 0.85/1
}
```

**‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á normalize?**
- Features ‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
- ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å feature ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
- ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏ó‡∏£‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô

---

## 5Ô∏è‚É£ OUTPUT CONFIGURATION

```python
OUTPUT_DIR = "outputs"
```

**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå:**
```
outputs/
‚îú‚îÄ‚îÄ best_model.pth              # ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
‚îú‚îÄ‚îÄ best_enhanced_model.pth     # ‡πÇ‡∏°‡πÄ‡∏î‡∏• enhanced ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
‚îú‚îÄ‚îÄ processed_data.pkl          # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß
‚îú‚îÄ‚îÄ training_history.pkl        # ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô
‚îú‚îÄ‚îÄ evaluation_results.pkl      # ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
‚îú‚îÄ‚îÄ traffic_gnn.log            # Log file
‚îî‚îÄ‚îÄ plots/                      # ‡∏Å‡∏£‡∏≤‡∏ü‡∏ï‡πà‡∏≤‡∏á‡πÜ
    ‚îú‚îÄ‚îÄ loss_curve.png
    ‚îú‚îÄ‚îÄ accuracy_plot.png
    ‚îú‚îÄ‚îÄ confusion_matrix.png
    ‚îî‚îÄ‚îÄ comparison_chart.png
```

---

```python
MODEL_SAVE_PATH = os.path.join(OUTPUT_DIR, "best_model.pth")
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ validation loss ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:**
```python
torch.save({
    'epoch': 35,
    'model_state_dict': model.state_dict(),
    'optimizer_state_dict': optimizer.state_dict(),
    'train_loss': 0.234,
    'val_loss': 0.287,
    'val_accuracy': {
        'congestion': 0.954,
        'rush_hour': 0.982
    },
    'config': CONFIG_DICT
}, MODEL_SAVE_PATH)
```

**‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ:**
```python
checkpoint = torch.load('outputs/best_model.pth')
model.load_state_dict(checkpoint['model_state_dict'])
print(f"Best epoch: {checkpoint['epoch']}")
print(f"Val accuracy: {checkpoint['val_accuracy']}")
```

---

```python
FIGURE_SIZE = (12, 8)
DPI = 300
SAVE_PLOTS = True
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

**1. FIGURE_SIZE:**
- ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü = 12√ó8 ‡∏ô‡∏¥‡πâ‡∏ß
- ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠/‡∏û‡∏¥‡∏°‡∏û‡πå

**2. DPI (Dots Per Inch):**
- 300 DPI = ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå)
- 72 DPI = ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠)

**3. SAVE_PLOTS:**
- `True` ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå
- `False` ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
import matplotlib.pyplot as plt

plt.figure(figsize=FIGURE_SIZE)
plt.plot(train_loss, label='Train')
plt.plot(val_loss, label='Validation')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.legend()

if SAVE_PLOTS:
    plt.savefig('outputs/plots/loss_curve.png', 
                dpi=DPI, 
                bbox_inches='tight')
else:
    plt.show()
```

---

## 6Ô∏è‚É£ DASHBOARD CONFIGURATION

```python
DASHBOARD_PORT = 8501
AUTO_REFRESH_SECONDS = 30
MAX_MAP_POINTS = 100
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

**1. DASHBOARD_PORT:**
- Dashboard ‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà: `http://localhost:8501`

**2. AUTO_REFRESH:**
- ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- Real-time monitoring

**3. MAX_MAP_POINTS:**
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 100 ‡∏à‡∏∏‡∏î‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤

---

```python
DEFAULT_MAP_CENTER = [13.7563, 100.5018]  # Bangkok
DEFAULT_ZOOM = 11
MAP_STYLE = 'OpenStreetMap'
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

**1. MAP_CENTER:**
- ‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á = ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£

**2. ZOOM Levels:**
```
1  - ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏•‡∏Å
5  - ‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
11 - ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‚úÖ
15 - ‡πÄ‡∏´‡πá‡∏ô‡∏¢‡πà‡∏≤‡∏ô
20 - ‡πÄ‡∏´‡πá‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
```

**3. MAP_STYLE:**
- `'OpenStreetMap'`: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
- `'CartoDB'`: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏≠‡∏≤‡∏î
- `'Stamen Terrain'`: ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®

---

```python
CONGESTION_COLORS = {
    'Gridlock': '#FF4444',    # ‡πÅ‡∏î‡∏á
    'Congested': '#FF8800',   # ‡∏™‡πâ‡∏°
    'Moderate': '#FFAA00',    # ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
    'Free Flow': '#44FF44'    # ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
}

RUSH_HOUR_COLORS = {
    'Non-Rush Hour': '#4ECDC4',  # ‡∏ü‡πâ‡∏≤
    'Rush Hour': '#FF6B6B'       # ‡πÅ‡∏î‡∏á
}
```

**Color Scheme:**
```
üî¥ #FF4444 Gridlock      ‚Üí ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° (‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢)
üü† #FF8800 Congested     ‚Üí ‡∏™‡πâ‡∏° (‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)
üü° #FFAA00 Moderate      ‚Üí ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (‡∏£‡∏∞‡∏ß‡∏±‡∏á)
üü¢ #44FF44 Free Flow     ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)

üîµ #4ECDC4 Non-Rush Hour ‚Üí ‡∏ü‡πâ‡∏≤ (‡∏õ‡∏Å‡∏ï‡∏¥)
üî¥ #FF6B6B Rush Hour     ‚Üí ‡πÅ‡∏î‡∏á‡∏≠‡πà‡∏≠‡∏ô (‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô)
```

---

## 7Ô∏è‚É£ LOGGING CONFIGURATION

```python
LOG_LEVEL = 'INFO'
LOG_FORMAT = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
LOG_FILE = os.path.join(OUTPUT_DIR, 'traffic_gnn.log')
```

**Log Levels:**
```
DEBUG    ‚Üí ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
INFO     ‚Üí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‚úÖ
WARNING  ‚Üí ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
ERROR    ‚Üí ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
CRITICAL ‚Üí ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Log Output:**
```
2024-10-05 08:30:45 - TrafficGNN - INFO - Starting training...
2024-10-05 08:30:50 - TrafficGNN - INFO - Epoch 1/50, Loss: 1.234
2024-10-05 08:31:00 - TrafficGNN - INFO - Epoch 2/50, Loss: 1.102
2024-10-05 09:15:20 - TrafficGNN - INFO - Training completed!
2024-10-05 09:15:25 - TrafficGNN - INFO - Best model saved.
```

---

## 8Ô∏è‚É£ THAI LOCALIZATION

```python
THAI_LABELS = {
    'congestion': {
        'Gridlock': '‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á',
        'Congested': '‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î',
        'Moderate': '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á',
        'Free Flow': '‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß'
    },
    'rush_hour': {
        'Rush Hour': '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô',
        'Non-Rush Hour': '‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥'
    }
}

THAI_TIME_FORMAT = '%H:%M ‡∏ô.'
THAI_DATE_FORMAT = '%d/%m/%Y'
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ:**
```python
# ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
label_en = "Gridlock"

# ‡πÅ‡∏õ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
label_th = THAI_LABELS['congestion'][label_en]
print(label_th)  # "‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á"

# ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
from datetime import datetime
now = datetime.now()
time_th = now.strftime(THAI_TIME_FORMAT)
date_th = now.strftime(THAI_DATE_FORMAT)
print(f"{time_th} {date_th}")  # "08:30 ‡∏ô. 05/10/2024"
```

---

## 9Ô∏è‚É£ SYSTEM CONFIGURATION

```python
USE_GPU = True
NUM_WORKERS = 4
PIN_MEMORY = True
MAX_MEMORY_GB = 8
BATCH_SIZE_AUTO_ADJUST = True
RANDOM_SEED = 42
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**

**1. USE_GPU:**
```python
if USE_GPU and torch.cuda.is_available():
    device = torch.device('cuda')
    print(f"Using GPU: {torch.cuda.get_device_name()}")
else:
    device = torch.device('cpu')
    print("Using CPU")
```

**2. NUM_WORKERS:**
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô threads ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- 4 workers = ‡πÇ‡∏´‡∏•‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô 4 ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£

**3. PIN_MEMORY:**
- ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô pinned memory
- ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CPU ‚Üí GPU ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô

**4. BATCH_SIZE_AUTO_ADJUST:**
```python
try:
    train_model(batch_size=64)
except RuntimeError as e:
    if "out of memory" in str(e):
        # ‡∏•‡∏î batch size ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        train_model(batch_size=32)
```

**5. RANDOM_SEED:**
```python
import random
import numpy as np
import torch

random.seed(RANDOM_SEED)
np.random.seed(RANDOM_SEED)
torch.manual_seed(RANDOM_SEED)
# ‚Üí ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
```

---

## üîü VALIDATION FUNCTION

```python
def validate_config():
    """‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤"""
    
    # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å
    assert AGGREGATION_MINUTES > 0
    assert MIN_PROBES_PER_BIN > 0
    assert EPOCHS > 0
    assert BATCH_SIZE > 0
    assert LEARNING_RATE > 0
    
    # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 0-1
    assert 0 < TRAIN_SPLIT < 1
    assert TRAIN_SPLIT + VAL_SPLIT <= 1
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå outputs
    os.makedirs(OUTPUT_DIR, exist_ok=True)
    
    print("‚úÖ Configuration validation passed!")
```

**‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```python
# ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°
if __name__ == "__main__":
    validate_config()
    # ‡∏à‡∏∞ error ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
```

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ

### **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î:**

| ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç |
|---------|--------|----------|
| Data | 10 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Model | 8 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Training | 8 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Graph | 5 | ‚≠ê‚≠ê‚≠ê‚≠ê |
| Output | 6 | ‚≠ê‚≠ê‚≠ê |
| Dashboard | 8 | ‚≠ê‚≠ê‚≠ê |
| Logging | 4 | ‚≠ê‚≠ê |
| Thai | 3 | ‚≠ê‚≠ê |
| System | 7 | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **‡∏£‡∏ß‡∏°** | **59** | |

### **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ config.py:**

‚úÖ **‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡πà‡∏≤‡∏¢** - ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß  
‚úÖ **‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î** - ‡∏°‡∏µ validation  
‚úÖ **‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢** - ‡∏™‡∏•‡∏±‡∏ö config ‡πÑ‡∏î‡πâ  
‚úÖ **‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢** - ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô  
‚úÖ **‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ** - import ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå

---

## üéì ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

```python
# ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ import config
from config import (
    BATCH_SIZE,
    LEARNING_RATE,
    EPOCHS,
    MODEL_SAVE_PATH
)

# ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å config
dataloader = DataLoader(
    dataset,
    batch_size=BATCH_SIZE
)

optimizer = Adam(
    model.parameters(),
    lr=LEARNING_RATE
)

for epoch in range(EPOCHS):
    train_one_epoch()
    
torch.save(model.state_dict(), MODEL_SAVE_PATH)
```

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠:** 5 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2025  
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** 1.0  
**‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô:** Traffic GNN Classification Team
